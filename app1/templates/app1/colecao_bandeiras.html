{% extends 'app1/base.html' %}
{% load static %}
{% block title %}Coleção de bandeiras{% endblock %}
{% block content %}
<div class="home-shell flag-collection-shell">
    <section class="section-block">
        <div class="section-title-row">
            <h3 class="section-heading">Sua coleção de bandeiras</h3>
        </div>
        <div class="flag-progress-card full">
            <div class="flag-progress-visual" style="background-image: url('{% static imagem_atual %}');">
                <div class="flag-progress-mask" style="width: {{ restante_percent }}%;"></div>
                <div class="flag-progress-chip">
                    <span class="flag-percent">{{ percent }}%</span>
                    <span class="flag-name">{{ flag_atual_nome }}</span>
                </div>
            </div>
            <div class="flag-progress-meta inline">
                <p class="flag-progress-remaining">Faltam {{ faltam }} notícias para chegar a 100%</p>
                <p class="flag-progress-total">Total lido: {{ total_lidos }} notícia(s)</p>
            </div>
        </div>
    </section>

    <section class="section-block">
        <h3 class="section-heading">Coleção</h3>
        <div class="flag-grid">
            {% for item in grid %}
            <div class="flag-card {{ item.status }}">
                <div class="flag-card-visual" style="background-image: url('{% static item.imagem %}');">
                    {% if item.status != 'complete' %}
                    <div class="flag-progress-mask" style="width: {{ item.restante_percent }}%;"></div>
                    {% endif %}
                    {% if item.status == 'locked' %}
                    <i class="fa-solid fa-lock flag-lock"></i>
                    {% endif %}
                </div>
                <div class="flag-card-footer">
                    <div>
                        <p class="flag-name">{{ item.nome }}</p>
                        <p class="flag-status-label">
                            {% if item.status == 'complete' %}
                                Completa
                            {% elif item.status == 'progress' %}
                                {{ item.percent }}% concluído
                            {% else %}
                                Bloqueada
                            {% endif %}
                        </p>
                    </div>
                    {% if item.status == 'progress' %}
                    <span class="flag-pill">Faltam {{ item.faltam }} notícias</span>
                    {% elif item.status == 'complete' %}
                    <span class="flag-pill done">Liberada</span>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <p class="empty">Nenhuma bandeira configurada.</p>
            {% endfor %}
        </div>
    </section>
</div>
{% endblock %}
